import{l as U,x as K,D as Q,o as c,g as N,a,w as i,y as M,h as e,n as h,b as r,z as P,G as R,S as Y,e as z,r as ee,c as u,u as l,Z as se,t as o,j as y,F as q,i as V,O as W,q as te,s as oe}from"./app-632bf8b8.js";import{d as w}from"./index-81635579.js";import{a as le}from"./index-4cd942bc.js";import{u as ae}from"./useAxios-d55f63a8.js";import{_ as v,a as ie,b as L}from"./AppButton-ffc821ac.js";import{P as F,W as j,d as ne,s as E,_ as de}from"./AuthenticatedLayout-6b95fe5a.js";import{c as ce}from"./Modal-1349d4bc.js";import{_ as re}from"./AppPagination-44a644fe.js";import{E as _e}from"./EmptyState-d0b40849.js";import{_ as I}from"./LabelText-36465a88.js";import"./TextInput-7865c9b5.js";import"./dayjs.min-356b711c.js";import"./SelectInput-944e57c4.js";import"./CheckboxInput-967d96fa.js";const ue={class:"mobile-modal"},pe={class:"mobile-purchases-filters"},he=e("div",{class:"mobile-purchases-filters__hr"},null,-1),me={__name:"ModalMobile",props:{show:{type:Boolean,default:!1},closeable:{type:Boolean,default:!0},currentSection:{type:String,default:"all"}},emits:["close","open"],setup(_,{emit:B}){const S=_,m=B;U(()=>S.show,()=>{S.show?($(),document.body.style.overflow="hidden"):document.body.style.overflow=null});const n=b=>{S.closeable&&m("close",b)},$=()=>{m("open")},x=b=>{b.key==="Escape"&&S.show&&n()};return K(()=>document.addEventListener("keydown",x)),Q(()=>{document.removeEventListener("keydown",x),document.body.style.overflow=null}),(b,p)=>(c(),N(Y,{to:"body"},[a(R,{"leave-active-class":"duration-200"},{default:i(()=>[M(e("div",ue,[e("div",pe,[he,a(v,{theme:"normal",class:h({btn_selected:_.currentSection=="processing"}),onClick:p[0]||(p[0]=k=>n("processing"))},{default:i(()=>[r(" Активные ")]),_:1},8,["class"]),a(v,{theme:"normal",class:h({btn_selected:_.currentSection=="done"}),onClick:p[1]||(p[1]=k=>n("done"))},{default:i(()=>[r(" Завершенные ")]),_:1},8,["class"]),a(v,{theme:"normal",class:h({btn_selected:_.currentSection=="unavailable"}),onClick:p[2]||(p[2]=k=>n("unavailable"))},{default:i(()=>[r(" Недоступные ")]),_:1},8,["class"]),a(v,{theme:"normal",class:h({btn_selected:_.currentSection=="all"}),onClick:p[3]||(p[3]=k=>n("all"))},{default:i(()=>[r(" Все ")]),_:1},8,["class"])])],512),[[P,_.show]])]),_:1})]))}};const f=_=>(te("data-v-bd3182e8"),_=_(),oe(),_),ve={key:0,class:"input-wrapper"},fe={key:1,class:"panel mb-6"},be={class:"flex gap-1.5"},ke=["href"],ge={key:0,class:"purchase-group"},ye={class:"purchase-group purchase-group__title"},we=["onClick"],Se={class:"purhcase-group__title"},$e=f(()=>e("div",null,null,-1)),xe={class:"purchase-group__progress"},Ce={key:1,class:"mobile-purchase-group"},De={class:"mobile-purchase-group__title"},Ge={class:"mobile-purchase-group__body"},ze=["onClick"],qe={class:"mobile-purchase-group__info"},Be={class:"mobile-purchase-group__progress"},Ee={class:"mobile-purchase-group__info__text"},Ie={class:"mobile-purchase-group__info__text"},Me={key:2,class:"products-header products-header_deliveries"},Pe=f(()=>e("div",{class:"products-header__product"},"Товар",-1)),Ve=f(()=>e("div",{class:"products-header__code"},"Артикул",-1)),Le=f(()=>e("div",{class:"products-header__quantity"},"Кол-во",-1)),Ne=f(()=>e("div",{class:"products-header__gender"},"Пол",-1)),Oe=f(()=>e("div",{class:"products-header__size"},"Размер",-1)),Te=f(()=>e("div",{class:"products-header__keywords"},"Поисковой запрос",-1)),Ae=f(()=>e("div",{class:"products-header__address"},[e("span",{class:"mr-1"},"Адрес ПВЗ")],-1)),He=[Pe,Ve,Le,Ne,Oe,Te,Ae],We={class:"product-list product-list_deliveries"},Fe={class:"product__product"},je={class:"product__image"},Ue=["href"],Xe=["src"],Ze={class:"product__info"},Je={class:"product__info-title"},Ke=["href"],Qe={class:"product__info-price"},Re={class:"product__code"},Ye={class:"product__quantity"},es={class:"product__gender"},ss={class:"product__size"},ts={class:"product__keywords"},os={key:0,class:"font-bold"},ls=["title"],as={class:"product__actions"},is={class:"mobile-product-card__image"},ns=["href"],ds=["src"],cs={class:"mobile-product-card__info"},rs={class:"mobile-product-card__info__top"},_s={class:"product__code"},us=f(()=>e("span",{class:"product__code__text"},"Код:",-1)),ps={class:"product__quantity"},hs={class:"mobile-product-card__info__bottom"},ms={class:"product__actions"},vs=f(()=>e("img",{src:"/images/empty-purchases.svg",alt:"Нет активных выкупов",width:"250",height:"200"},null,-1)),fs=f(()=>e("p",null,"Создайте выкуп, чтобы начать продвигать товары в рейтинге",-1)),bs={__name:"Purchases",props:{section:{type:String,default:"processing"},purchaseGroups:{type:Array,default:()=>[]},paginator:{type:Array,required:!0}},setup(_){const B=_,S=ae(),{width:m}=le(),n=z(B.section),$=z(!1),x=z(!1),b=z("Активные"),p=z("Нет активных выкупов");U(()=>n.value,()=>{n.value==="processing"?(b.value="Активные",p.value="Нет активных выкупов"):n.value==="done"?(b.value="Завершенные",p.value="Нет завершёных выкупов"):n.value==="unavailable"?(b.value=" Недоступные",p.value="Нет недоступных выкупов"):(b.value="Все",p.value="Пока нет выкупов")});const k=g=>{n.value=g,W.reload({only:["purchaseGroups","paginator"],data:{section:n.value,page:1}})},X=g=>{S.post(route("purchases.destroy"),{purchase_id:g}).then(d=>{W.reload({only:["purchaseGroups"],data:{section:n.value}})}).catch(d=>{alert(d.response.data.message)})},Z=ee(B.purchaseGroups.reduce((g,d)=>[...g,{...d,collapsed:!0,progress:100}],[])),J=g=>{$.value=!1,x.value=!1,k(g)};return(g,d)=>(c(),u(q,null,[a(l(se),{title:"Liker"}),a(de,null,{header:i(()=>[r(" Выкупы ")]),default:i(()=>[l(w)().isDesktop&&l(m)>390?y("",!0):(c(),u("div",ve,[e("div",{onClick:d[0]||(d[0]=t=>$.value=!$.value),class:"mobile-section-input"},[e("p",null,o(b.value),1),a(L,{icon:"chevron-down"})])])),l(w)().isDesktop&&l(m)>390?(c(),u("div",fe,[e("div",be,[a(v,{theme:"normal",class:h({btn_selected:n.value=="processing"}),onClick:d[1]||(d[1]=t=>k("processing"))},{default:i(()=>[r(" Активные ")]),_:1},8,["class"]),a(v,{theme:"normal",class:h({btn_selected:n.value=="done"}),onClick:d[2]||(d[2]=t=>k("done"))},{default:i(()=>[r(" Завершенные ")]),_:1},8,["class"]),a(v,{theme:"normal",class:h({btn_selected:n.value=="unavailable"}),onClick:d[3]||(d[3]=t=>k("unavailable"))},{default:i(()=>[r(" Недоступные ")]),_:1},8,["class"]),a(v,{theme:"normal",class:h({btn_selected:n.value=="all"}),onClick:d[4]||(d[4]=t=>k("all"))},{default:i(()=>[r(" Все ")]),_:1},8,["class"]),e("a",{class:"ml-auto",href:"/purchase/download?status="+n.value,target:"_blank",download:""},[a(v,null,{default:i(()=>[r("Скачать XLS")]),_:1})],8,ke)])])):y("",!0),_.purchaseGroups.length>0?(c(),u(q,{key:2},[(c(!0),u(q,null,V(Z,t=>(c(),u("div",{key:t.id,class:h(l(w)().isDesktop&&l(m)>390?"panel panel_product mb-6":"mobile-purchasesGroup")},[l(w)().isDesktop&&l(m)>390?(c(),u("div",ge,[e("div",ye,[e("div",{class:h([{"rotate-180":!t.collapsed},"transition-all"]),onClick:s=>t.collapsed=!t.collapsed},[a(L,{icon:"chevron-down"})],10,we),e("div",Se," #"+o(t.id)+" Выкуп от "+o(t.created_ts),1),$e,a(I,null,{default:i(()=>[r(" Товаров: "+o(t.purchases.length)+" шт. ",1)]),_:2},1024),a(I,null,{default:i(()=>[r(" Сумма выкупов: "+o(t.total_sum)+" ₽ ",1)]),_:2},1024)]),e("div",xe,[e("p",null," Завершено "+o(t.purchases.filter(s=>s.status==="done").length)+" из "+o(t.purchases.length),1),a(F,{progress:Math.round(t.purchases.filter(s=>s.status==="done").length*100/t.purchases.length)},null,8,["progress"])])])):(c(),u("div",Ce,[e("div",De," #"+o(t.id)+" Выкуп от "+o(t.created_ts),1),e("div",Ge,[e("div",{class:h([{"rotate-180":!t.collapsed},"transition-all mobile-purchase-group__body__collapsed"]),onClick:s=>t.collapsed=!t.collapsed},[a(L,{icon:"chevron-down"})],10,ze),e("div",qe,[e("div",Be,[e("p",null," Завершено "+o(t.purchases.filter(s=>s.status==="done").length)+" из "+o(t.purchases.length),1),a(F,{progress:Math.round(t.purchases.filter(s=>s.status==="done").length*100/t.purchases.length)},null,8,["progress"])]),e("div",Ee," Товаров: "+o(t.purchases.length)+" шт. ",1),e("div",Ie," Сумма выкупов: "+o(t.total_sum)+" ₽ ",1)])])])),l(w)().isDesktop&&l(m)>390?M((c(),u("div",Me,He,512)),[[P,t.collapsed]]):y("",!0),e("div",We,[l(w)().isDesktop&&l(m)>390?(c(!0),u(q,{key:0},V(t.purchases,s=>{var C,D,G,O,T,A,H;return M((c(),u("div",{key:s.id,class:"product"},[e("div",Fe,[e("div",je,[e("a",{href:"https://www.wildberries.ru/catalog/"+((C=s.product)==null?void 0:C.remote_id)+"/detail.aspx",target:"_blank",rel:"noopener noreferrer"},[e("img",{src:l(j).constructHostV2((D=s.product)==null?void 0:D.remote_id)+"/images/tm/1.webp",alt:"",width:"30",height:"40"},null,8,Xe)],8,Ue)]),e("div",Ze,[e("div",Je,[e("a",{href:"https://www.wildberries.ru/catalog/"+((G=s.product)==null?void 0:G.remote_id)+"/detail.aspx",target:"_blank",rel:"noopener noreferrer"},o(s.task_id)+" "+o((O=s.product)==null?void 0:O.name),9,Ke)]),e("div",Qe,o(s.purchase_ts),1)])]),e("div",Re,o((T=s.product)==null?void 0:T.remote_id),1),e("div",Ye,o(s.quantity),1),e("div",es,o(l(ne)[s.gender].name),1),e("div",ss,o((A=s.size)!=null&&A.name?(H=s.size)==null?void 0:H.name:"---"),1),e("div",ts,[s.search_position>0?(c(),u("span",os," ("+o(s.search_position)+") ",1)):y("",!0),r(" "+o(s.keywords),1)]),e("div",{class:"product__address",title:s.address},o(s.address),9,ls),e("div",as,[a(I,{theme:l(E)[s.status].theme},{default:i(()=>[r(o(l(E)[s.status].title),1)]),_:2},1032,["theme"]),s.status=="processing"?(c(),N(v,{key:0,size:"sm",icon:"delete",theme:"danger",onClick:ks=>X(s.id)},null,8,["onClick"])):y("",!0)])])),[[P,t.collapsed]])}),128)):(c(!0),u(q,{key:1},V(t.purchases,s=>{var C,D,G;return M((c(),u("div",{key:"mobile-"+s.id,class:"mobile-product-card"},[e("div",is,[e("a",{href:"https://www.wildberries.ru/catalog/"+((C=s.product)==null?void 0:C.remote_id)+"/detail.aspx",target:"_blank",rel:"noopener noreferrer"},[e("img",{src:l(j).constructHostV2((D=s.product)==null?void 0:D.remote_id)+"/images/tm/1.webp",alt:"",width:"30",height:"40"},null,8,ds)],8,ns)]),e("div",cs,[e("div",rs,[e("div",_s,[us,r(" "+o((G=s.product)==null?void 0:G.remote_id),1)]),e("div",ps,"Кол-во: "+o(s.quantity),1)]),e("div",hs,[e("div",ms,[a(I,{theme:l(E)[s.status].theme},{default:i(()=>[r(o(l(E)[s.status].title),1)]),_:2},1032,["theme"])])])])])),[[P,t.collapsed]])}),128))])],2))),128)),l(w)().isDesktop&&l(m)>390?(c(),N(re,{key:0,links:_.paginator},null,8,["links"])):y("",!0)],64)):y("",!0),_.purchaseGroups.length==0?(c(),u("div",{key:3,class:h(["panel flex flex-col grow",l(w)().isDesktop&&l(m)>390?"panel flex flex-col grow":"mobile-purchases-empty"])},[a(_e,{class:"grow"},{title:i(()=>[r(o(p.value),1)]),image:i(()=>[vs]),default:i(()=>[fs,a(v,{icon:"plus-circle",onClick:d[5]||(d[5]=t=>l(ce).open())},{default:i(()=>[r("Создать выкуп")]),_:1})]),_:1})],2)):y("",!0),a(me,{show:$.value,currentSection:n.value,onClose:J,onOpen:d[6]||(d[6]=t=>x.value=!0)},null,8,["show","currentSection"])]),_:1})],64))}},Ms=ie(bs,[["__scopeId","data-v-bd3182e8"]]);export{Ms as default};
