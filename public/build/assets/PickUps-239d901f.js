import{d as B,e as D,o,g as r,w as s,b as a,a as i,h as t,c as f,t as _,u as l,O as A,f as F,l as N,Z as P,n as x,j as d,F as T,i as q}from"./app-632bf8b8.js";import{d as z}from"./dayjs.min-356b711c.js";import{_ as M}from"./ModalMobileTariffs-3123fdf5.js";import{c as V,_ as j,u as I}from"./AuthenticatedLayout-6b95fe5a.js";import{e as E,_ as O,f as L}from"./Modal-1349d4bc.js";import{d as $}from"./index-81635579.js";import{a as W}from"./index-4cd942bc.js";import{_ as k,b as X}from"./AppButton-ffc821ac.js";import{_ as Z}from"./AppPagination-44a644fe.js";import{T as Y,A as G}from"./TableTh-6fdd4a53.js";import{E as H}from"./EmptyState-d0b40849.js";import{_ as c}from"./LabelText-36465a88.js";import{u as J}from"./useAxios-d55f63a8.js";import"./TextInput-7865c9b5.js";import"./SelectInput-944e57c4.js";import"./CheckboxInput-967d96fa.js";const K={class:"excel-import__step"},Q=t("div",{class:"excel-import__step-caption"},"1. Скачайте и заполните шаблон",-1),R={href:"/files/import-pick-up-template.xlsx",target:"_blank",download:""},U={class:"excel-import__step"},ee=t("div",{class:"excel-import__step-caption"},"2. Веберите или перетащиет файл шаблона",-1),te={class:"input-dndfile"},se={for:"importPickUpExcel",class:"input-dndfile__label"},ae={key:0,class:"input-dndfile__label-caption"},oe={key:1},le={__name:"PickUpImportModal",setup(w){const h=B(),m=J(),p=D(null),C=()=>{let g=new FormData;g.append("file",p.value),m.post(route("pick-ups.import"),g).then(v=>{E.close(),h.success("Заборы имортированны из Excel!");const n=v.data.errors;if(n.product_not_found>0&&h.warning("Пропущено строк (не найден товар) "+n.product_not_found),n.empty_phone>0&&h.warning("Пропущено строк (нет телефона) "+n.empty_phone),n.empty_code>0&&h.warning("Пропущено строк (нет кода получения) "+n.empty_code),n.wrong_address>0&&h.warning("Пропущено строк (не верный адрес) "+n.wrong_address),n.empty_qr_code>0&&h.warning("Пропущено строк (отсутсвует qr код) "+n.empty_qr_code),n.missing_addresses){let S="";n.missing_addresses.forEach(b=>{S=`${b}; ${S}`}),h.warning(S)}A.reload()}).catch(v=>{v.response.data.error&&h.error(v.response.data.error)})},y=g=>{p.value=g.target.files[0]};return(g,v)=>(o(),r(O,{show:l(E).show,onClose:v[0]||(v[0]=n=>l(E).close()),"body-class":"modal__body_generator"},{header:s(()=>[a(" Импортировать из Excel ")]),actions:s(()=>[i(k,{size:"lg",onClick:C,disabled:p.value==null},{default:s(()=>[a(" Импортировать ")]),_:1},8,["disabled"])]),default:s(()=>[t("div",K,[Q,t("a",R,[i(k,{fillwidth:"",theme:"outline",size:"lg",icon:"file-download"},{default:s(()=>[a(" Скачать шаблон ")]),_:1})])]),t("div",U,[ee,t("div",te,[t("input",{type:"file",id:"importPickUpExcel",onChange:y,class:"input-dndfile__input",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},null,32),t("label",se,[p.value?(o(),f("div",oe,_(p.value.name),1)):(o(),f("div",ae," Перетащите или выберите файл "))])])])]),_:1},8,["show"]))}},ne=t("title",null,"Услуги по забору товара",-1),ie={key:0,class:"flex mb-4"},de={key:1,class:"input-wrapper"},re={key:2,class:"panel mb-6"},ue={class:"flex gap-1.5"},ce={class:"ml-auto flex gap-3"},_e={class:"text-xs text-gray-400"},me={class:"text-xs text-gray-400"},pe={class:"text-xs text-gray-400"},fe={class:"pr-6"},he={class:"pl-6 flex justify-end"},ve={key:1},ke={class:"mobile-pickup__top"},ye={class:"mobile-pickup__top-header"},ge={class:"mobile-pickup__top-id"},be=t("span",{class:"mobile-pickup__top-span"},"id: ",-1),xe={class:"mobile-pickup__top-phone"},$e=t("span",{class:"mobile-pickup__top-tel"},"тел.: ",-1),we={class:"mobile-pickup__name"},Ce={class:"mobile-pickup__adress"},Se={class:"mobile-pickup__pickup"},De=t("span",{class:"mobile-pickup__pickup-span"},"pickUp:  ",-1),Ee={class:"mobile-pickup__bottom"},Te=t("div",{class:"header-5 mb-1.5"},"Заборов пока нет",-1),Ze={__name:"PickUps",props:{pickUps:{type:Array,required:!0},section:{type:String,required:!0},paginator:{type:Array,required:!0},pendingTotalSum:{type:Number,required:!0}},setup(w){const h=w,m=D(h.section),{width:p}=W(),C=D(!1),y=D("Ожидает обработки"),g=["pending","process","done","all"],v=F(()=>h.pendingTotalSum/100-I.balance),n=b=>{m.value=b,A.reload({only:["pickUps","paginator","section"],data:{section:m.value,page:1}})},S=b=>{n(b),C.value=!1};return N(()=>m.value,()=>{m.value==="pending"?y.value="Ожидает обработки":m.value==="process"?y.value="В процессе":m.value==="done"?y.value="Выполненные ":y.value="Все"}),(b,u)=>(o(),f(T,null,[i(l(P),null,{default:s(()=>[ne]),_:1}),i(j,null,{header:s(()=>[a("Услуги по забору товара")]),default:s(()=>[t("div",{class:x(l($)().isDesktop&&l(p)>390?"-mt-4 mb-4":"mobile-pickup-danger")},[i(c,{theme:"danger"},{default:s(()=>[a(" Заявки принимаются с 00:00 до 10:55 текущего дня ")]),_:1})],2),v.value>0?(o(),f("div",ie,[i(c,{theme:"danger"},{default:s(()=>[a(" У вас недостаточно средств для проведения заборов (не хватает "+_(l(V).format(v.value))+") ",1)]),_:1}),i(k,{theme:"outline",size:"sm",class:"ml-4",onClick:u[0]||(u[0]=e=>l(L).open())},{default:s(()=>[a(" Пополнить баланс ")]),_:1})])):d("",!0),l($)().isDesktop&&l(p)>390?d("",!0):(o(),f("div",de,[t("div",{onClick:u[1]||(u[1]=e=>C.value=!C.value),class:"mobile-section-input"},[t("p",null,_(y.value),1),i(X,{icon:"chevron-down"})])])),l($)().isDesktop&&l(p)>390?(o(),f("div",re,[t("div",ue,[i(k,{theme:"normal",class:x({btn_selected:m.value=="pending"}),onClick:u[2]||(u[2]=e=>n("pending"))},{default:s(()=>[a(" Ожидает обработки ")]),_:1},8,["class"]),i(k,{theme:"normal",class:x({btn_selected:m.value=="process"}),onClick:u[3]||(u[3]=e=>n("process"))},{default:s(()=>[a(" В процессе ")]),_:1},8,["class"]),i(k,{theme:"normal",class:x({btn_selected:m.value=="done"}),onClick:u[4]||(u[4]=e=>n("done"))},{default:s(()=>[a(" Выполненные ")]),_:1},8,["class"]),i(k,{theme:"normal",class:x({btn_selected:m.value=="all"}),onClick:u[5]||(u[5]=e=>n("all"))},{default:s(()=>[a(" Все ")]),_:1},8,["class"]),t("div",ce,[i(k,{size:"md",onClick:u[6]||(u[6]=e=>l(E).open())},{default:s(()=>[a(" Импорт XLS ")]),_:1})])])])):d("",!0),w.pickUps.length?(o(),f("div",{key:3,class:x(l($)().isDesktop&&l(p)>390?"panel panel_product":"mobile-pickup__body")},[l($)().isDesktop&&l(p)>390?(o(),r(G,{key:0},{head:s(()=>[t("tr",null,[i(Y,{class:"text-left"},{default:s(()=>[a("Товар")]),_:1}),i(Y,{class:"text-left"},{default:s(()=>[a("Артикул")]),_:1}),i(Y,{class:"text-left"})])]),default:s(()=>[(o(!0),f(T,null,q(w.pickUps,e=>(o(),f("tr",{key:e.id,class:"main-table__tr"},[t("td",null,[t("div",null,_(e.product.name),1),t("div",_e,_(e.address),1),t("div",me,_(e.phone),1),t("div",pe," #"+_(e.id)+" "+_(l(z)(e.created_at).format("D/M/YYYY h:m")),1)]),t("td",null,[t("div",fe,_(e.product_id),1)]),t("td",null,[t("div",he,[e.status==0?(o(),r(c,{key:0,theme:"info"},{default:s(()=>[a(" Ожидает обработки ")]),_:1})):d("",!0),e.status==1?(o(),r(c,{key:1,theme:"info"},{default:s(()=>[a(" В процессе ")]),_:1})):d("",!0),e.status==2?(o(),r(c,{key:2,theme:"success"},{default:s(()=>[a(" Завершено ")]),_:1})):d("",!0),e.status==-1?(o(),r(c,{key:3,theme:"danger"},{default:s(()=>[a(" Не забран ")]),_:1})):d("",!0),e.status==-2?(o(),r(c,{key:4,theme:"danger"},{default:s(()=>[a(" Недостаточно средств ")]),_:1})):d("",!0),e.status==-3?(o(),r(c,{key:5,theme:"danger"},{default:s(()=>[a(" Не найден адрес ")]),_:1})):d("",!0),e.status==-4?(o(),r(c,{key:6,theme:"danger"},{default:s(()=>[a(" Адрес не поддерживается ")]),_:1})):d("",!0)])])]))),128))]),_:1})):(o(),f("div",ve,[(o(!0),f(T,null,q(w.pickUps,e=>(o(),f("div",{key:e.id,class:"mobile-pickup__item"},[t("div",ke,[t("div",ye,[t("div",ge,[be,a(" "+_(e.product_id),1)]),t("div",xe,[$e,a(_(e.phone),1)])]),t("div",we,_(e.product.name),1),t("div",Ce,_(e.address),1),t("div",Se,[De,a(" # "+_(e.id)+" "+_(l(z)(e.created_at).format("D/M/YYYY h:m")),1)])]),t("div",Ee,[e.status==0?(o(),r(c,{key:0,theme:"info"},{default:s(()=>[a(" Ожидает обработки ")]),_:1})):d("",!0),e.status==1?(o(),r(c,{key:1,theme:"info"},{default:s(()=>[a(" В процессе ")]),_:1})):d("",!0),e.status==2?(o(),r(c,{key:2,theme:"success"},{default:s(()=>[a(" Завершено ")]),_:1})):d("",!0),e.status==-1?(o(),r(c,{key:3,theme:"danger"},{default:s(()=>[a(" Не забран ")]),_:1})):d("",!0),e.status==-2?(o(),r(c,{key:4,theme:"danger"},{default:s(()=>[a(" Недостаточно средств ")]),_:1})):d("",!0),e.status==-3?(o(),r(c,{key:5,theme:"danger"},{default:s(()=>[a(" Не найден адрес ")]),_:1})):d("",!0),e.status==-4?(o(),r(c,{key:6,theme:"danger"},{default:s(()=>[a(" Адрес не поддерживается ")]),_:1})):d("",!0)])]))),128))])),l($)().isDesktop&&l(p)>390?(o(),r(Z,{key:2,links:w.paginator},null,8,["links"])):d("",!0)],2)):(o(),f("div",{key:4,class:x(l($)().isDesktop&&l(p)>390?"panel flex flex-col grow":"mobile-pickup__empty")},[i(H,{class:"grow"},{default:s(()=>[Te]),_:1})],2)),i(M,{show:C.value,currentSection:m.value,sections:g,onClose:S,onOpen:u[7]||(u[7]=e=>b.disableInput=!0)},null,8,["show","currentSection"])]),_:1}),i(le)],64))}};export{Ze as default};
